<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="aa.css" type="text/css" media="all" />
  <title>Laison</title>
  <style>body{
  margin: 0 0 0 0;
  padding: 0 0 0 0;
  background: #212121;
}

header{
  width: 100%;
  color: white;
font-weight: 900;
}
header img{
  width: 2rem;
  height: 2rem;
  border-radius: 20px;
  
}
#mensagens{
  position: fixed;
  top: 77vh;
  width: 100%;
  
}
#mensagens input{
  width: 70%;
  padding: 12px;
  color: white;
  border-radius: 10px;
  background: none;
  border: 1px solid white;
  outline: none;
}
#mensagens button{
  width: 20%;
 padding: 10px;
 font-style: 1rem;
 font-weight: 900;
 background: #212121;
 color: white;
 border: 1px solid white;
 border-radius: 10px;
}
#chat{
  width: 100%;
  height: 80vh;
  overflow-y: scroll;
  border: 1px solid none;
}
#bot{
  border: 1px solid white;
  width: 50%;
  background: #212121;
  padding: 12px;
  color: white;
  border-radius: 20px;
  margin-left: 1rem;
  
      flex-wrap: wrap;
}



/* √Årea do chat */
#chat {
  width: 100%;
  height: 400px;
  overflow-y: scroll;
  border-radius: 10px;
  
  overflow-y: auto;
  background: #212121;
  display: flex;
  flex-direction: column;
  gap: 1px;
}

/* Mensagens base */
.msg {
  max-width: 70%;
  padding: 8px 12px;
  border-radius: 12px;
  font-size: 14px;
  line-height: 1.4;
}

/* Mensagens do usu√°rio (√† direita) */
.msg.user {
  align-self: flex-end;
  background: darkred;
  color: white;
  border-bottom-right-radius: 0;
}

/* Mensagens do bot (√† esquerda) */
.msg.bot {
  align-self: flex-start;
  background: #e5e5ea;
  color: #333;
  border-bottom-left-radius: 0;
}

</style>
</head>
<body>
<header>
  <img src="laison.png" alt="" />
  <span>LIA</span>
</header>

<div id="chat"></div>

<div id="mensagens">
  <input type="text" id="textoDousuario" placeholder="Digita a sua mensagem"/>
  <button onclick="send()">Send</button>
</div>

<script>
  const messagesDiv = document.getElementById("chat");
  const input = document.getElementById("textoDousuario");

  // Fala
  function speak(text) {
    const synth = window.speechSynthesis;
    const utter = new SpeechSynthesisUtterance(text);
    utter.lang = "pt-BR";
    synth.speak(utter);
  }

  // Exibir mensagens
  function addMessage(text, sender) {
    const div = document.createElement("div");
    div.className = "msg " + sender;
    div.textContent = text;
    messagesDiv.appendChild(div);
    messagesDiv.scrollTop = messagesDiv.scrollHeight;
  }

  // Responder mensagens
  async function botReply(message) {
    const msg = message.toLowerCase();

    // Sauda√ß√µes
    const saudacoes = ["oi", "ol√°", "ola", "bom dia", "boa tarde", "boa noite", "salve"];
    if (saudacoes.some(s => msg.includes(s))) {
      let resposta = "Ol√°! Como voc√™ est√°?";
      if (msg.includes("bom dia")) resposta = "Bom dia! Espero que seu dia seja √≥timo üåû";
      if (msg.includes("boa tarde")) resposta = "Boa tarde! Tudo bem por a√≠?";
      if (msg.includes("boa noite")) resposta = "Boa noite! Bons sonhos quando for dormir üåô";
      addMessage(resposta, "bot");
      speak(resposta);
      return;
    }

    // Piadas
    if (["piada", "piadinha", "engra√ßado"].some(k => msg.includes(k))) {
      const res = await fetch("https://official-joke-api.appspot.com/random_joke");
      const joke = await res.json();
      const resposta = `${joke.setup} ... ${joke.punchline}`;
      addMessage(resposta, "bot");
      speak(resposta);
      return;
    }

    // Curiosidades
    if (["curiosidade", "fato", "novidade"].some(k => msg.includes(k))) {
      const res = await fetch("https://uselessfacts.jsph.pl/api/v2/facts/random?language=en");
      const fact = await res.json();
      const resposta = "Voc√™ sabia que: " + fact.text;
      addMessage(resposta, "bot");
      speak(resposta);
      return;
    }

    // Gatos
    if (["gato", "gatinho", "felino"].some(k => msg.includes(k))) {
      const res = await fetch("https://api.thecatapi.com/v1/images/search");
      const data = await res.json();
      const resposta = "Aqui est√° um gato fofo üò∫ " + data[0].url;
      addMessage(resposta, "bot");
      speak("Aqui est√° um gato fofo!");
      return;
    }

    // Cachorros
    if (["cachorro", "dog", "c√£o", "au au"].some(k => msg.includes(k))) {
      const res = await fetch("https://dog.ceo/api/breeds/image/random");
      const data = await res.json();
      const resposta = "Olha s√≥ esse cachorro üê∂ " + data.message;
      addMessage(resposta, "bot");
      speak("Olha s√≥ esse cachorro!");
      return;
    }

    // Matem√°tica
    if (["+", "-", "*", "/", "%", "^"].some(op => msg.includes(op))) {
      try {
        const resultado = eval(msg);
        const resposta = "O resultado √©: " + resultado;
        addMessage(resposta, "bot");
        speak(resposta);
        return;
      } catch {}
    }

    // Clima / Temperatura
    if (["clima", "tempo", "temperatura", "previs√£o"].some(k => msg.includes(k))) {
      if (navigator.geolocation) {
        navigator.geolocation.getCurrentPosition(async (position) => {
          const lat = position.coords.latitude;
          const lon = position.coords.longitude;
          try {
            const res = await fetch(`https://geocoding-api.open-meteo.com/v1/reverse?latitude=${lat}&longitude=${lon}&language=pt`);
            const geo = await res.json();
            const cidade = geo[0]?.name || "sua regi√£o";

            const climaRes = await fetch(`https://api.open-meteo.com/v1/forecast?latitude=${lat}&longitude=${lon}&current_weather=true`);
            const clima = await climaRes.json();
            const temp = clima.current_weather.temperature;
            const vento = clima.current_weather.windspeed;

            const resposta = `Agora em ${cidade} est√° ${temp}¬∞C com ventos de ${vento} km/h.`;
            addMessage(resposta, "bot");
            speak(resposta);
          } catch {
            const resposta = "N√£o consegui pegar o clima agora üòû";
            addMessage(resposta, "bot");
            speak(resposta);
          }
        });
        return;
      } else {
        const resposta = "Seu navegador n√£o permite pegar a localiza√ß√£o para consultar o clima.";
        addMessage(resposta, "bot");
        speak(resposta);
        return;
      }
    }

    // Wikipedia (fallback)
    try {
      const res = await fetch(`https://pt.wikipedia.org/api/rest_v1/page/summary/${encodeURIComponent(msg)}`);
      const data = await res.json();
      if (data.extract) {
        const resposta = data.extract;
        addMessage(resposta, "bot");
        speak(resposta);
        return;
      }
    } catch {}

    // √öltimo fallback
    const resposta = "N√£o encontrei nada sobre isso.";
    addMessage(resposta, "bot");
    speak(resposta);
  }

  // Enviar mensagens
  function send() {
    const text = input.value.trim();
    if (!text) return;
    addMessage(text, "user"); // <-- Corrigido aqui
    input.value = "";
    botReply(text);
  }

  input.addEventListener("keydown", (e) => {
    if (e.key === "Enter") send();
  });
</script>
</body>
</html>
